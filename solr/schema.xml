<?xml version="1.0" encoding="UTF-8" ?>

<schema name="cihm:cap-20100413" version="1.1">

  <types>
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="sint" class="solr.SortableIntField" sortMissingLast="true" omitNorms="true"/>
    <fieldType name="date" class="solr.DateField" sortMissingLast="true" omitNorms="true"/>

    <fieldType name="text" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.ISOLatin1AccentFilterFactory"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.ISOLatin1AccentFilterFactory"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldType>

    <fieldType name="text_en" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.ISOLatin1AccentFilterFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords-en.txt" enablePositionIncrements="true"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.SnowballPorterFilterFactory" language="English"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.ISOLatin1AccentFilterFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords-en.txt" enablePositionIncrements="true"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.SnowballPorterFilterFactory" language="English"/>
      </analyzer>
    </fieldType>

    <fieldType name="text_fr" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.ISOLatin1AccentFilterFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords-fr.txt" enablePositionIncrements="true"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.SnowballPorterFilterFactory" language="French"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.ISOLatin1AccentFilterFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords-fr.txt" enablePositionIncrements="true"/>
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.SnowballPorterFilterFactory" language="French"/>
      </analyzer>
    </fieldType>

  </types>

  <fields>
  
    <!-- Universally-Required Fields-->
    <field name="key" type="string" required="true" indexed="true" stored="true"/>
    <field name="type" type="string" required="true" indexed="true" stored="true"/>
    <field name="contributor" type="string" required="true" indexed="true" stored="true"/>
    <field name="label" type="string" required="true" indexed="true" stored="true"/>
    <field name="clabel" type="string" required="true" indexed="true" stored="true"/>
    <field name="pubmin" type="date" required="true" indexed="true" stored="true"/>
    <field name="pubmax" type="date" required="true" indexed="true" stored="true"/>

    <!-- Other Control Fields -->
    <field name="pkey" type="string" indexed="true" stored="true"/>
    <field name="gkey" type="string" indexed="true" stored="true" multiValued="true"/>
    <field name="seq" type="sint" indexed="true" stored="true"/>
    <field name="id" type="string" indexed="true" stored="true" multiValued="true"/>

    <!-- Universal Descriptive Information -->
    <field name="lang" type="string" indexed="true" stored="true" multiValued="true"/>

    <!-- Digital content (file) and resource (URI) description -->
    <!-- Note that the file profile is deprecated; its function has merged with resource -->
    <field name="mime" type="string" indexed="true" stored="true"/>
    <field name="size" type="sint" indexed="true" stored="true"/>
    <field name="md5" type="string" indexed="false" stored="true"/>
    <field name="role" type="string" indexed="true" stored="true"/>
    <field name="uri" type="string" indexed="true" stored="true" multiValued="true"/>
    <field name="localaccess" type="sint" indexed="true" stored="true"/>

    <!-- Simple Bibliographic Description -->
    <field name="pubstmt" type="text" indexed="true" stored="true"/>
    <field name="pubdate" type="text" indexed="true" stored="true"/>
    <field name="ti" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="au" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="su" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="no" type="text" indexed="true" stored="true" multiValued="true"/>

    <!-- Keyword anywhere bibliographic search -->
    <field name="kw" type="text" indexed="true" stored="false" multiValued="true"/>

    <!-- Descriptor, summary, abstract, page text -->
    <field name="ds" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="sm" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="ab" type="text" indexed="true" stored="true" multiValued="true"/>
    <field name="tx" type="text" indexed="true" stored="true" multiValued="true"/>
    <dynamicField name="ds_*" type="text" indexed="true" stored="true" multiValued="true"/>

    <!-- MARC Record Fields: e.g.: marc_100, marc_245a, marc_245ac -->
    <dynamicField name="marc_*" type="text" indexed="true" stored="true" multiValued="true"/>

    <!-- Any field with a _lang suffix gets indexed using the appropriate
    language factories -->
    <dynamicField name="*_en" type="text_en" indexed="true" stored="false" multiValued="true"/>
    <dynamicField name="*_fr" type="text_fr" indexed="true" stored="false" multiValued="true"/>

    <!-- Material and content descriptors -->
    <field name="mtype" type="string" indexed="true" stored="true" multiValued="true"/>
    <field name="ctype" type="string" indexed="true" stored="true" multiValued="true"/>

  </fields>

  <copyField source="tx_*" dest="tx"/>
  <copyField source="ti_*" dest="ti"/>
  <copyField source="au_*" dest="au"/>
  <copyField source="su_*" dest="su"/>
  <copyField source="no_*" dest="no"/>
  <copyField source="kw_*" dest="kw"/>
  <copyField source="ds_*" dest="ds"/>
  <copyField source="sm_*" dest="sm"/>
  <copyField source="ab_*" dest="ab"/>

  <uniqueKey>key</uniqueKey>
  <defaultSearchField>tx</defaultSearchField>
  <solrQueryParser defaultOperator="AND"/>

</schema>
