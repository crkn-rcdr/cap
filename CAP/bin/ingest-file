#!/usr/bin/perl -Ilib
use strict;
use warnings;

=head1 NAME

inget - ingest the contents of a directory structure into Canadiana Access Portal

=head1 SYNOPSIS



=cut
use File::Basename;
use Config::General;
use Getopt::Long;
use Ingest;

my $prog = basename($0);
my $conf_file = "./cap.conf";
my $contributor;
my $usage = "Usage: $prog --conf CONFIG_FILE --contributor CONTRIBUTOR FILE [FILE...]\n";

GetOptions(
    'conf=s' => \$conf_file,
    'contributor=s' => \$contributor,
) or die ($usage);

die ($usage) unless($conf_file && $contributor);

my $conf= new Config::General(
    -ConfigFile => $conf_file,
    );
my %config =  $conf->getall ;


my $ingest= new Ingest(%config);

foreach my $file (@ARGV) {
   
    my $fqfn = $ingest->ingest_file($file, $contributor); 
    print "$fqfn\n";
}
