#
#  General Catalyst Configuration 
#

name CAP
debug 1
default_view Default

# Set this value to 1 (or some other true value) to enable extended
# debugging messages related to authorization and authentication. This
# will result in supplied password information being written to log files,
# so enable this feature with care.
debug_auth 1

# Database connection info
<Component Model::DB>
    schema_class CAP::Schema
    <connect_info>
        dsn dbi:mysql:cap
        user cap
        password ""
    </connect_info>
</Component>

#
# Application-Specific Configuration
#

default_portal co

version 0.20100414

# These path names must be relative to the application 'root'.

# Root of the repository
repository ../../../data/repos

# Where uploaded files go
uploads ../../../data/uploads

# Path to the content repository (TIFF images, PDFs, etc.)
content /Users/william/co/content

# Where we can find the application profiles
profiles /Users/william/co/cap/tools/profiles

# Number of issues or other child elements to display at a time.
children_per_page 10

# Where we can find the NetPBM programs
netpbm_path /opt/local/bin

# The MIME types we can presently handle.
<MimeTypes>
  image/tiff = true
  image/jpeg = true
  application/pdf = true
</MimeTypes>

# Default parameters. These should all be set to sensible values, or the
# application may behave strangely.
<defaults>
    image_size = 600 # default width (in pixels) for derivative images
    image_min = 50 # minimum size allowed for derivative images
    image_max = 1200 # maximum size allowed for derivative images
</defaults>

<solr>

  select_uri http://localhost:8984/solr/select
  update_uri http://localhost:8984/solr/update

  # Comment this out or set to 0 if you're getting double-encoding
  # problems from the Web server (e.g. fastcgi)
  utf8_encode 0

  <fields>
    tx tx # global text field
    tx tx_en # English text
    tx tx_fr # French text
    ti ti # global title field
    ti ti_en # etc.
    ti ti_fr
    au au
    au au_en
    au au_fr
    su su
    su su_en
    su su_fr
    no no
    no no_en
    no no_fr
    kw kw
    kw kw_en
    kw kw_fr
    q  tx
    q  tx_en
    q  tx_fr
    q  kw
    q  kw_en
    q  kw_fr
  </fields>

</solr>

# Configurable template options
<Display>
  thumbsize 50 # default thumbnail size
  # Default width for page images
  imgsize 500
</Display>


<action "/auth/login">
  enabled true
  public true
</action>

<action "/auth/logout">
  enabled true
  public true
</action>

<action "/file/file">
  enabled true
  public true
</action>

<action "/file/get">
  enabled true
  public true
</action>

<action "/page">
  enabled true
  public true
</action>

<action "/post">
  enabled true
  public true
</action>

<action "/index">
  enabled true
  public true
</action>

<action "/search/search">
  enabled true
  public true
</action>

<action "/show/index">
  enabled true
  public true
</action>

<action "/static">
  enabled true
  public true
</action>

<action "/test_error">
  enabled true
  public true
</action>


<action "/content/cleanup">
  enabled false
  public false
</action>

<action "/content/commit">
  enabled false
  public false
</action>

<action "/content/ingest">
  enabled false
  public false
</action>

<action "/content/upload">
  enabled false
  public false
</action>

<action "/system/index">
  enabled false
  public false
</action>

<action "/system/i18n">
  enabled false
  public false
</action>

<action "/user/index">
  enabled false
  public false
</action>

<action "/user/create">
  enabled false
  public false
</action>

<action "/user/edit">
  enabled false
  public false
</action>

<action "/user/roles">
  enabled false
  public false
</action>


<actions>
  # Core user API

  # Administrative API
  /content/cleanup !
  /content/commit  !
  /content/ingest  !
  /content/upload  !


  /index *
  /auth/login *
  /auth/logout *
  /file/file *
  /file/get *
  /page *
  /post *
  /search/search *
  /show/show *
  /test_error *
  /static *

  /system/index ! 
  /system/i18n !

  /user/index !
  /user/create !
  /user/edit !
  /user/roles !
</actions>

<contributor>
  oocihm Canadiana.org
  ooe Department of Foreign Affairs and International Trade
  qmbn Bibliothèque et Archives Nationales du Québec
</contributor>

<prefix>
    #http://localhost:3000/ dfait/en
    #http://localhost:3000/ admin/en
    #http://dfait.cihm/ dfait/en
    http://www.canadianaenligne.ca/ co/fr
    http://www.canadianaonline.ca/ co/en
</prefix>

# Where to look for additional portal configurations, relative to the
# application root.
#portals ../portals

# You can configure individual portals here instead of putting them in
# their own configuration file by naming them. E.g.,
# configure portal "foo" within <portal><foo>...</foo></portal>. This may
# improve performance because the server doesn't have to re-read the
# external config file for each request, but any changes made here require
# restarting the server, whereas the config file in $portals are "live."
# If you name a portal "foo" here and have a $portals/foo.conf file, the
# latter will completely clobber the configuration here.
#<portal>
# Even if this is empty, it still needs to exist, for now.
#</portal>

# List of valid contributor codes/userids with descriptions
#<Contributors>
#    oocihm Canadiana.org
#    ooe Department of Foreign Affairs and International Trade
#</Contributors>
